# ì •ë³´ê²€ìƒ‰ ê¸°ë§ í”„ë¡œì íŠ¸

**ì§ì ‘ êµ¬í˜„í•œ ê²€ìƒ‰ ì—”ì§„ ì‹œìŠ¤í…œ**

ë³¸ í”„ë¡œì íŠ¸ëŠ” ì •ë³´ê²€ìƒ‰ì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œë¥¼ ì´í•´í•˜ê³ , Inverted Indexë¶€í„° ë­í‚¹ ì•Œê³ ë¦¬ì¦˜, UI, ì„±ëŠ¥ í‰ê°€ê¹Œì§€ ì „ì²´ IR íŒŒì´í”„ë¼ì¸ì„ ì²˜ìŒë¶€í„° ì§ì ‘ êµ¬í˜„í•œ ê²€ìƒ‰ ì—”ì§„ì…ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
- [ì‹œìŠ¤í…œ êµ¬ì¡°](#ì‹œìŠ¤í…œ-êµ¬ì¡°)
- [ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
- [ì‘ë™ ì›ë¦¬](#ì‘ë™-ì›ë¦¬)
- [ì„¤ì¹˜ ë° ì‹¤í–‰](#ì„¤ì¹˜-ë°-ì‹¤í–‰)
- [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
- [ì„±ëŠ¥ í‰ê°€](#ì„±ëŠ¥-í‰ê°€)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)

---

## í”„ë¡œì íŠ¸ ê°œìš”

### ëª©í‘œ
- ê²€ìƒ‰ ì—”ì§„ì˜ í•µì‹¬ êµ¬ì¡° ì´í•´
- ì¸ë±ì‹±, ê²€ìƒ‰, ë­í‚¹, UI, í‰ê°€ê¹Œì§€ ì „ì²´ íŒŒì´í”„ë¼ì¸ êµ¬í˜„
- ë‹¤ì–‘í•œ ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ ë¹„êµ ë° ë¶„ì„

### íŠ¹ì§•
- âœ… **ì™„ì „ ìì²´ êµ¬í˜„**: ëª¨ë“  ì¸ë±ì‹± ë° ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ ì§ì ‘ êµ¬í˜„
- âœ… **ë‹¤ì–‘í•œ ë­í‚¹ ë°©ë²•**: BM25, TF-IDF, í•˜ì´ë¸Œë¦¬ë“œ ë­í‚¹ ì§€ì›
- âœ… **ê³ ê¸‰ ê¸°ëŠ¥**: ì¿¼ë¦¬ í™•ì¥, Cross-Encoder ë¦¬ë­í‚¹
- âœ… **ì²´ê³„ì  í‰ê°€**: TREC Eval í‘œì¤€ ì§€í‘œë¡œ ì„±ëŠ¥ ì¸¡ì •
- âœ… **ì‚¬ìš©ì ì¹œí™”ì  UI**: Streamlit ê¸°ë°˜ ì›¹ ì¸í„°í˜ì´ìŠ¤

### ë°ì´í„°ì…‹
- **wikir/en1k**: ìœ„í‚¤í”¼ë””ì•„ ê¸°ë°˜ IR ë°ì´í„°ì…‹
- ë¬¸ì„œ: 369,712ê°œ
- ì¿¼ë¦¬: training 1,444 / validation 100 / test 100
- Relevance levels: 0 (not relevant), 1 (relevant), 2 (highly relevant)

---

## ì‹œìŠ¤í…œ êµ¬ì¡°

### ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì‚¬ìš©ì ì¿¼ë¦¬ ì…ë ¥                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Query Processor (ì¿¼ë¦¬ ì²˜ë¦¬)                 â”‚
â”‚  â€¢ í† í¬ë‚˜ì´ì§•                                            â”‚
â”‚  â€¢ ì¿¼ë¦¬ í™•ì¥ (ì„ íƒ)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Inverted Index (ì—­ìƒ‰ì¸)                       â”‚
â”‚  â€¢ Posting List: {term: [(doc_id, tf), ...]}           â”‚
â”‚  â€¢ Document Frequency                                   â”‚
â”‚  â€¢ Document Length                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Ranking Engine (ë­í‚¹ ì—”ì§„)                       â”‚
â”‚  â€¢ BM25 ë­í‚¹                                            â”‚
â”‚  â€¢ TF-IDF ë­í‚¹                                          â”‚
â”‚  â€¢ í•˜ì´ë¸Œë¦¬ë“œ ë­í‚¹ (BM25 + TF-IDF)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Reranker (ì¬ìˆœìœ„í™”, ì„ íƒ)                        â”‚
â”‚  â€¢ Cross-Encoder ê¸°ë°˜ ë¦¬ë­í‚¹                            â”‚
â”‚  â€¢ Top-K í›„ë³´ ì¬ìˆœìœ„í™”                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ê²€ìƒ‰ ê²°ê³¼ ì¶œë ¥                               â”‚
â”‚  â€¢ ë¬¸ì„œ ID, ì ìˆ˜, ìŠ¤ë‹ˆí«                                 â”‚
â”‚  â€¢ ì¿¼ë¦¬ í•˜ì´ë¼ì´íŒ…                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° íë¦„

1. **ì¸ë±ì‹± ë‹¨ê³„**: ë¬¸ì„œ â†’ í† í¬ë‚˜ì´ì§• â†’ Inverted Index êµ¬ì¶•
2. **ê²€ìƒ‰ ë‹¨ê³„**: ì¿¼ë¦¬ â†’ í† í¬ë‚˜ì´ì§• â†’ Posting List ì¡°íšŒ â†’ ì ìˆ˜ ê³„ì‚° â†’ ì •ë ¬
3. **ë¦¬ë­í‚¹ ë‹¨ê³„**: (ì„ íƒ) Top-K í›„ë³´ â†’ Cross-Encoder ì¬ìˆœìœ„í™”
4. **ê²°ê³¼ ì¶œë ¥**: ì ìˆ˜ìˆœ ì •ë ¬ëœ ë¬¸ì„œ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

---

## ì£¼ìš” ê¸°ëŠ¥

### 1. ì¸ë±ì‹± (Indexing)

#### Inverted Index êµ¬ì¶•
- **êµ¬ì¡°**: `{term: [(doc_id, term_frequency), ...]}`
- **ì €ì¥ ì •ë³´**:
  - Posting List: ê° ë‹¨ì–´ê°€ ë‚˜íƒ€ë‚˜ëŠ” ë¬¸ì„œì™€ ë¹ˆë„
  - Document Frequency: ê° ë‹¨ì–´ê°€ ë‚˜íƒ€ë‚˜ëŠ” ë¬¸ì„œ ìˆ˜
  - Document Length: ê° ë¬¸ì„œì˜ ê¸¸ì´ (ì •ê·œí™”ìš©)
  - Document Store: ì›ë³¸ ë¬¸ì„œ í…ìŠ¤íŠ¸ (ìŠ¤ë‹ˆí« ìƒì„±ìš©)

#### í† í¬ë‚˜ì´ì§•
- ì˜ì–´ í…ìŠ¤íŠ¸ ì²˜ë¦¬
- ì†Œë¬¸ì ë³€í™˜
- Stopwords ì œê±°
- ìµœì†Œ ê¸¸ì´ í•„í„°ë§ (2ì ì´ìƒ)

### 2. ë­í‚¹ ì•Œê³ ë¦¬ì¦˜

#### BM25 (Best Matching 25)
```
score(D,Q) = Î£ IDF(q) Ã— (tf Ã— (k1+1)) / (tf + k1 Ã— (1-b + bÃ—|D|/avgdl))

IDF(q) = log((N - df + 0.5) / (df + 0.5) + 1)
```
- **íŠ¹ì§•**: ë¬¸ì„œ ê¸¸ì´ ì •ê·œí™” í¬í•¨
- **íŒŒë¼ë¯¸í„°**: k1=1.5, b=0.75
- **ì¥ì **: ê¸´ ë¬¸ì„œì— ëŒ€í•œ í˜ë„í‹° ìë™ ì¡°ì ˆ

#### TF-IDF (Term Frequency-Inverse Document Frequency)
```
TF-IDF(t,d) = TF(t,d) Ã— IDF(t)

TF(t,d) = term_frequency / document_length
IDF(t) = log(N / DF(t))
```
- **íŠ¹ì§•**: ë‹¨ìˆœí•˜ê³  ì§ê´€ì ì¸ ê°€ì¤‘ì¹˜
- **ì¥ì **: í¬ê·€ ë‹¨ì–´ì— ë†’ì€ ê°€ì¤‘ì¹˜ ë¶€ì—¬

#### í•˜ì´ë¸Œë¦¬ë“œ ë­í‚¹
```
hybrid_score = Î± Ã— BM25_score + (1-Î±) Ã— TF-IDF_score
```
- **íŠ¹ì§•**: ë‘ ì•Œê³ ë¦¬ì¦˜ì˜ ì¥ì  ê²°í•©
- **ê°€ì¤‘ì¹˜ ì¡°ì ˆ**: ì‚¬ìš©ìê°€ Î± ê°’ ì¡°ì ˆ ê°€ëŠ¥ (0.0 ~ 1.0)

### 3. ì¿¼ë¦¬ í™•ì¥ (Query Expansion)

#### ë™ì˜ì–´ í™•ì¥
- ì‚¬ì „ ê¸°ë°˜ ë™ì˜ì–´ ì¶”ê°€
- ì˜ˆ: "car" â†’ "automobile", "vehicle", "auto"

#### ê³µì¶œí˜„ ê¸°ë°˜ í™•ì¥
- ì¸ë±ìŠ¤ í†µê³„ë¥¼ í™œìš©í•œ ê´€ë ¨ì–´ íƒìƒ‰
- ì¿¼ë¦¬ ë‹¨ì–´ì™€ í•¨ê»˜ ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” ë‹¨ì–´ ìë™ ì¶”ê°€

### 4. Cross-Encoder ë¦¬ë­í‚¹

- **ëª¨ë¸**: `cross-encoder/ms-marco-MiniLM-L-6-v2`
- **ìš©ë„**: BM25/TF-IDF top-100 í›„ë³´ë¥¼ ì¬ìˆœìœ„í™”
- **íš¨ê³¼**: ê²€ìƒ‰ ì •í™•ë„ í–¥ìƒ

### 5. ì„±ëŠ¥ í‰ê°€

#### TREC Eval ì§€í‘œ
- **MAP** (Mean Average Precision): ì „ì²´ í‰ê·  ì •ë°€ë„
- **Precision@k**: ìƒìœ„ kê°œ ê²°ê³¼ì˜ ì •ë°€ë„ (k=5, 10, 20)
- **Recall@k**: ìƒìœ„ kê°œ ê²°ê³¼ì˜ ì¬í˜„ìœ¨
- **nDCG@k**: ì •ê·œí™”ëœ í• ì¸ ëˆ„ì  ì´ë“

---

## ì‘ë™ ì›ë¦¬

### ì¸ë±ì‹± í”„ë¡œì„¸ìŠ¤

1. **ë¬¸ì„œ ë¡œë“œ**: TSV íŒŒì¼ì—ì„œ ë¬¸ì„œ ì½ê¸°
2. **í† í¬ë‚˜ì´ì§•**: ê° ë¬¸ì„œë¥¼ í† í°ìœ¼ë¡œ ë¶„ë¦¬
3. **TF ê³„ì‚°**: ê° ë¬¸ì„œì—ì„œ ë‹¨ì–´ë³„ ë¹ˆë„ ê³„ì‚°
4. **Posting List êµ¬ì¶•**: `{term: [(doc_id, tf), ...]}` êµ¬ì¡° ìƒì„±
5. **í†µê³„ ê³„ì‚°**: Document Frequency, í‰ê·  ë¬¸ì„œ ê¸¸ì´ ê³„ì‚°
6. **ì €ì¥**: ì¸ë±ìŠ¤ë¥¼ pickle íŒŒì¼ë¡œ ì €ì¥

### ê²€ìƒ‰ í”„ë¡œì„¸ìŠ¤

1. **ì¿¼ë¦¬ ì…ë ¥**: ì‚¬ìš©ìê°€ ê²€ìƒ‰ì–´ ì…ë ¥
2. **ì¿¼ë¦¬ ì²˜ë¦¬**:
   - í† í¬ë‚˜ì´ì§•
   - (ì„ íƒ) ì¿¼ë¦¬ í™•ì¥
3. **Posting List ì¡°íšŒ**: ê° ì¿¼ë¦¬ ë‹¨ì–´ì˜ posting list ê²€ìƒ‰
4. **ì ìˆ˜ ê³„ì‚°**:
   - BM25 ë˜ëŠ” TF-IDF ì ìˆ˜ ê³„ì‚°
   - ë¬¸ì„œë³„ ì ìˆ˜ í•©ì‚°
5. **ì •ë ¬**: ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
6. **ë¦¬ë­í‚¹** (ì„ íƒ): Cross-Encoderë¡œ top-K ì¬ìˆœìœ„í™”
7. **ê²°ê³¼ ë°˜í™˜**: ìƒìœ„ Kê°œ ë¬¸ì„œ ë°˜í™˜

### ì˜ˆì‹œ: "machine learning" ê²€ìƒ‰

```
1. ì¿¼ë¦¬ í† í¬ë‚˜ì´ì§•: ["machine", "learning"]
2. Posting List ì¡°íšŒ:
   - "machine" â†’ [(doc_1, 3), (doc_5, 1), ...]
   - "learning" â†’ [(doc_1, 5), (doc_3, 2), ...]
3. ì ìˆ˜ ê³„ì‚°:
   - doc_1: BM25("machine", doc_1) + BM25("learning", doc_1)
   - doc_3: BM25("learning", doc_3)
   - doc_5: BM25("machine", doc_5)
4. ì •ë ¬: doc_1 > doc_3 > doc_5 > ...
5. ê²°ê³¼ ë°˜í™˜: ìƒìœ„ 10ê°œ ë¬¸ì„œ
```

---

## ì„¤ì¹˜ ë° ì‹¤í–‰

### í™˜ê²½ ìš”êµ¬ì‚¬í•­

- Python 3.7 ì´ìƒ
- 8GB ì´ìƒ RAM (ì¸ë±ì‹± ì‹œ)
- ì¸í„°ë„· ì—°ê²° (ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ ë° ëª¨ë¸ ë‹¤ìš´ë¡œë“œ)

### 1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone <repository-url>
cd ir_project
```

### 2. ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”

```bash
# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv

# Windows
venv\Scripts\activate

# Mac/Linux
source venv/bin/activate
```

### 3. íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip install -r requirements.txt
```

í•„ìš”í•œ íŒ¨í‚¤ì§€:
- `ir_datasets`: ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ
- `torch`: ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬
- `transformers`: HuggingFace ëª¨ë¸
- `streamlit`: ì›¹ UI
- `tqdm`: ì§„í–‰ë¥  í‘œì‹œ

---

## ì‚¬ìš© ë°©ë²•

### Step 1: ë°ì´í„° ë‹¤ìš´ë¡œë“œ

```bash
python download_data.py
```

**ì‘ì—… ë‚´ìš©:**
- wikir/en1k ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ
- `data/` í´ë”ì— ì €ì¥:
  - `documents.tsv`: 369,712ê°œ ë¬¸ì„œ
  - `queries_training.tsv`: í•™ìŠµìš© ì¿¼ë¦¬
  - `queries_validation.tsv`: ê²€ì¦ìš© ì¿¼ë¦¬
  - `queries_test.tsv`: í…ŒìŠ¤íŠ¸ìš© ì¿¼ë¦¬
  - `qrels_*.tsv`: Relevance judgments

**ì˜ˆìƒ ì‹œê°„**: ì•½ 5-10ë¶„ (ì¸í„°ë„· ì†ë„ì— ë”°ë¼ ë‹¤ë¦„)

### Step 2: ì¸ë±ìŠ¤ êµ¬ì¶•

```bash
python build_index.py
```

**ì‘ì—… ë‚´ìš©:**
- ëª¨ë“  ë¬¸ì„œë¥¼ ì½ì–´ì„œ í† í¬ë‚˜ì´ì§•
- Inverted Index êµ¬ì¶•
- í†µê³„ ì •ë³´ ê³„ì‚° (DF, í‰ê·  ë¬¸ì„œ ê¸¸ì´ ë“±)
- `data/index.pkl` íŒŒì¼ë¡œ ì €ì¥

**ì˜ˆìƒ ì‹œê°„**: ì•½ 10-15ë¶„ (369,712ê°œ ë¬¸ì„œ ì²˜ë¦¬)

**ì¶œë ¥ ì˜ˆì‹œ:**
```
==================================================
Building BM25 Index
==================================================
[Indexer] Loading documents from data/documents.tsv
[Indexer] Building index for 369712 documents...
Indexing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 369712/369712 [10:23<00:00, 593.45it/s]
[Indexer] Done. 369712 docs, 1234567 unique terms
==================================================
Index saved to data/index.pkl
Total documents: 369712
Vocabulary size: 1234567
Average doc length: 234.56
==================================================
```

### Step 3: ì„±ëŠ¥ í‰ê°€ (ì„ íƒ)

```bash
# Validation setìœ¼ë¡œ í‰ê°€ (ê¸°ë³¸)
python run_eval.py

# Test setìœ¼ë¡œ í‰ê°€
python run_eval.py --split test
```

**ì‘ì—… ë‚´ìš©:**
- ê° ì¿¼ë¦¬ì— ëŒ€í•´ ê²€ìƒ‰ ì‹¤í–‰
- BM25, TF-IDF, Hybrid, Reranker ì„±ëŠ¥ ë¹„êµ
- TREC Eval ì§€í‘œ ê³„ì‚°
- ê²°ê³¼ë¥¼ `results/` í´ë”ì— ì €ì¥

**ì¶œë ¥ ì˜ˆì‹œ:**
```
============================================================
Evaluation on validation set
============================================================

Loading index...
Loading rankers...
Loading evaluator...

------------------------------------------------------------
Evaluating BM25...
------------------------------------------------------------
Searching: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [02:15<00:00,  1.35s/it]

BM25 Results:
  MAP: 0.3245
  P@5: 0.4567
  P@10: 0.4234
  ...
```

### Step 4: ì›¹ ë°ëª¨ ì‹¤í–‰

```bash
streamlit run app.py
```

ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8501 ìë™ìœ¼ë¡œ ì—´ë¦¼

**UI ê¸°ëŠ¥:**
- ê²€ìƒ‰ì–´ ì…ë ¥
- ë­í‚¹ ë°©ë²• ì„ íƒ (BM25 / TF-IDF / Hybrid)
- Reranker ì˜µì…˜ ì¼œê¸°/ë„ê¸°
- ì¿¼ë¦¬ í™•ì¥ ì˜µì…˜ ì¼œê¸°/ë„ê¸°
- ê²€ìƒ‰ ê²°ê³¼ í™•ì¸:
  - ë¬¸ì„œ ID, ì ìˆ˜
  - ìŠ¤ë‹ˆí« (ì¿¼ë¦¬ ë‹¨ì–´ í•˜ì´ë¼ì´íŒ…)
  - ì „ì²´ ë¬¸ì„œ ë³´ê¸°
- ê²€ìƒ‰ íˆìŠ¤í† ë¦¬
- ì¿¼ë¦¬ ë¶„ì„ (ë‹¨ì–´ ë¹ˆë„, IDF)

---

## ì„±ëŠ¥ í‰ê°€

### í‰ê°€ ì§€í‘œ ì„¤ëª…

#### MAP (Mean Average Precision)
- ê° ì¿¼ë¦¬ì˜ Average Precisionì˜ í‰ê· 
- ì „ì²´ì ì¸ ê²€ìƒ‰ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ëŒ€í‘œ ì§€í‘œ

#### Precision@k
- ìƒìœ„ kê°œ ê²°ê³¼ ì¤‘ ê´€ë ¨ ë¬¸ì„œì˜ ë¹„ìœ¨
- ì˜ˆ: P@10 = 0.4 â†’ ìƒìœ„ 10ê°œ ì¤‘ 4ê°œê°€ ê´€ë ¨ ë¬¸ì„œ

#### Recall@k
- ìƒìœ„ kê°œ ê²°ê³¼ì—ì„œ ì°¾ì€ ê´€ë ¨ ë¬¸ì„œ ìˆ˜ / ì „ì²´ ê´€ë ¨ ë¬¸ì„œ ìˆ˜
- ëª¨ë“  ê´€ë ¨ ë¬¸ì„œë¥¼ ì–¼ë§ˆë‚˜ ì°¾ì•˜ëŠ”ì§€ ì¸¡ì •

#### nDCG@k (Normalized Discounted Cumulative Gain)
- ìˆœìœ„ë¥¼ ê³ ë ¤í•œ ì„±ëŠ¥ ì§€í‘œ
- ìƒìœ„ ê²°ê³¼ì— ë” ë†’ì€ ê°€ì¤‘ì¹˜ ë¶€ì—¬
- ì •ê·œí™”í•˜ì—¬ 0~1 ì‚¬ì´ ê°’

### ê²°ê³¼ í•´ì„

```
Metric       BM25     TF-IDF    Hybrid    Reranker
----------------------------------------------------
MAP         0.3245    0.3189    0.3312    0.3891
P@5         0.4567    0.4456    0.4623    0.5234
P@10        0.4234    0.4123    0.4312    0.4891
nDCG@10     0.4123    0.4012    0.4212    0.4789
```

**ë¶„ì„:**
- BM25ì™€ TF-IDFëŠ” ë¹„ìŠ·í•œ ì„±ëŠ¥
- Hybrid ë­í‚¹ì´ ì•½ê°„ì˜ ì„±ëŠ¥ í–¥ìƒ
- Rerankerê°€ ê°€ì¥ ë†’ì€ ì„±ëŠ¥ (ì•½ 20% í–¥ìƒ)

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ir_project/
â”‚
â”œâ”€â”€ src/                          # ì†ŒìŠ¤ ì½”ë“œ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ tokenizer.py              # í…ìŠ¤íŠ¸ í† í¬ë‚˜ì´ì €
â”‚   â”‚   â””â”€â”€ Tokenizer            # ì˜ì–´ í…ìŠ¤íŠ¸ í† í¬ë‚˜ì´ì§•
â”‚   â”‚
â”‚   â”œâ”€â”€ indexer.py                # Inverted Index êµ¬ì¶•
â”‚   â”‚   â””â”€â”€ InvertedIndex        # ì—­ìƒ‰ì¸ êµ¬ì¡° ë° êµ¬ì¶• ë¡œì§
â”‚   â”‚
â”‚   â”œâ”€â”€ ranker.py                 # BM25 ë­í‚¹
â”‚   â”‚   â””â”€â”€ BM25Ranker           # BM25 ìŠ¤ì½”ì–´ë§ ì•Œê³ ë¦¬ì¦˜
â”‚   â”‚
â”‚   â”œâ”€â”€ tfidf_ranker.py          # TF-IDF ë­í‚¹
â”‚   â”‚   â””â”€â”€ TFIDFRanker          # TF-IDF ìŠ¤ì½”ì–´ë§ ì•Œê³ ë¦¬ì¦˜
â”‚   â”‚
â”‚   â”œâ”€â”€ searcher.py               # í†µí•© ê²€ìƒ‰ ì—”ì§„
â”‚   â”‚   â””â”€â”€ SearchEngine         # ê²€ìƒ‰ íŒŒì´í”„ë¼ì¸ í†µí•©
â”‚   â”‚
â”‚   â”œâ”€â”€ query_expander.py         # ì¿¼ë¦¬ í™•ì¥
â”‚   â”‚   â””â”€â”€ QueryExpander        # ë™ì˜ì–´ ë° ê³µì¶œí˜„ ê¸°ë°˜ í™•ì¥
â”‚   â”‚
â”‚   â”œâ”€â”€ reranker.py               # Cross-Encoder ë¦¬ë­í‚¹
â”‚   â”‚   â””â”€â”€ CrossEncoderReranker # ì‹ ê²½ë§ ê¸°ë°˜ ì¬ìˆœìœ„í™”
â”‚   â”‚
â”‚   â””â”€â”€ evaluator.py              # TREC Eval í‰ê°€ ì§€í‘œ
â”‚       â””â”€â”€ Evaluator             # MAP, P@k, R@k, nDCG ê³„ì‚°
â”‚
â”œâ”€â”€ download_data.py              # ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ build_index.py                # ì¸ë±ìŠ¤ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ run_eval.py                   # ì„±ëŠ¥ í‰ê°€ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ app.py                        # ì›¹ UI (Streamlit)
â”‚
â”œâ”€â”€ data/                         # ë°ì´í„° ì €ì¥ (ìë™ ìƒì„±)
â”‚   â”œâ”€â”€ documents.tsv            # ì›ë³¸ ë¬¸ì„œ (ì œì¶œ ì‹œ ì œì™¸)
â”‚   â”œâ”€â”€ queries_*.tsv            # ì¿¼ë¦¬ íŒŒì¼
â”‚   â”œâ”€â”€ qrels_*.tsv              # Relevance judgments
â”‚   â””â”€â”€ index.pkl                # êµ¬ì¶•ëœ ì¸ë±ìŠ¤ (ì œì¶œ ì‹œ ì œì™¸)
â”‚
â”œâ”€â”€ results/                      # í‰ê°€ ê²°ê³¼ (ìë™ ìƒì„±)
â”‚   â”œâ”€â”€ bm25_validation.txt       # BM25 TREC ê²°ê³¼
â”‚   â”œâ”€â”€ tfidf_validation.txt     # TF-IDF TREC ê²°ê³¼
â”‚   â”œâ”€â”€ hybrid_validation.txt    # Hybrid TREC ê²°ê³¼
â”‚   â”œâ”€â”€ rerank_validation.txt    # Reranker TREC ê²°ê³¼
â”‚   â””â”€â”€ summary_validation.txt   # ì„±ëŠ¥ ìš”ì•½
â”‚
â”œâ”€â”€ requirements.txt              # íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ README.md                     # í”„ë¡œì íŠ¸ ì„¤ëª…ì„œ (ë³¸ íŒŒì¼)
â”œâ”€â”€ PROJECT_REPORT.md             # í”„ë¡œì íŠ¸ ë³´ê³ ì„œ
â”œâ”€â”€ REQUIREMENTS_CHECKLIST.md     # ìš”êµ¬ì‚¬í•­ ì²´í¬ë¦¬ìŠ¤íŠ¸
â””â”€â”€ SUBMISSION_GUIDE.md           # ì œì¶œ ê°€ì´ë“œ
```

### ì£¼ìš” íŒŒì¼ ì„¤ëª…

#### `src/indexer.py`
- Inverted Index í´ë˜ìŠ¤ êµ¬í˜„
- ë¬¸ì„œ ì¶”ê°€, ì¸ë±ìŠ¤ êµ¬ì¶•, ì €ì¥/ë¡œë“œ ê¸°ëŠ¥

#### `src/ranker.py`
- BM25 ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„
- IDF ê³„ì‚°, ë¬¸ì„œ ê¸¸ì´ ì •ê·œí™” í¬í•¨

#### `src/tfidf_ranker.py`
- TF-IDF ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„
- TF ë° IDF ê³„ì‚°

#### `src/searcher.py`
- í†µí•© ê²€ìƒ‰ ì—”ì§„
- ë‹¤ì–‘í•œ ë­í‚¹ ë°©ë²• ì§€ì›
- ì¿¼ë¦¬ í™•ì¥ ë° ë¦¬ë­í‚¹ í†µí•©
- ìŠ¤ë‹ˆí« ìƒì„±

#### `src/evaluator.py`
- TREC Eval ì§€í‘œ êµ¬í˜„
- MAP, Precision@k, Recall@k, nDCG ê³„ì‚°
- TREC í˜•ì‹ ê²°ê³¼ ì €ì¥

#### `app.py`
- Streamlit ê¸°ë°˜ ì›¹ UI
- ê²€ìƒ‰ ì¸í„°í˜ì´ìŠ¤ ë° ê²°ê³¼ í‘œì‹œ

---

## ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­ âœ…
- âœ… Inverted Index ì§ì ‘ êµ¬í˜„
- âœ… BM25 ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ ì§ì ‘ êµ¬í˜„
- âœ… TF-IDF ë­í‚¹ ì•Œê³ ë¦¬ì¦˜ ì§ì ‘ êµ¬í˜„
- âœ… TREC Eval ì§€í‘œ ì§ì ‘ êµ¬í˜„ (MAP, P@k, R@k, nDCG)
- âœ… ì›¹ UI êµ¬í˜„ (Streamlit)

### ì¶”ê°€ ê¸°ëŠ¥ (ì°½ì˜ì  ìš”ì†Œ) ğŸ¨
- âœ… í•˜ì´ë¸Œë¦¬ë“œ ë­í‚¹ (BM25 + TF-IDF ê°€ì¤‘ ê²°í•©)
- âœ… ì¿¼ë¦¬ í™•ì¥ (ë™ì˜ì–´ + ê³µì¶œí˜„ ê¸°ë°˜)
- âœ… Cross-Encoder ê¸°ë°˜ ë¦¬ë­í‚¹
- âœ… í˜ì´ì§€ë„¤ì´ì…˜
- âœ… ì¿¼ë¦¬ í•˜ì´ë¼ì´íŒ…
- âœ… ê²€ìƒ‰ íˆìŠ¤í† ë¦¬
- âœ… ì¿¼ë¦¬ ë¶„ì„ ê¸°ëŠ¥
- âœ… ì„±ëŠ¥ ë¹„êµ ë¦¬í¬íŠ¸ ìƒì„±

---

## ì œì•½ì‚¬í•­ ë° ì£¼ì˜ì‚¬í•­

### ì œì•½ì‚¬í•­ ì¤€ìˆ˜ âœ…
- âœ… ì™¸ë¶€ ê²€ìƒ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¯¸ì‚¬ìš© (Elasticsearch, Lucene, Solr ë“±)
- âœ… HuggingFace ì‚¬ì „ í•™ìŠµ ëª¨ë¸ë§Œ ì‚¬ìš© (Rerankingìš©)
- âœ… ëª¨ë“  ì¸ë±ì‹± ë° ë­í‚¹ ë¡œì§ ì§ì ‘ êµ¬í˜„

### ì£¼ì˜ì‚¬í•­
- **ì¸ë±ì‹± ì‹œê°„**: 369,712ê°œ ë¬¸ì„œ ì¸ë±ì‹±ì— ì•½ 10-15ë¶„ ì†Œìš”
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ì¸ë±ìŠ¤ êµ¬ì¶• ì‹œ ì•½ 2-3GB RAM í•„ìš”
- **ëª¨ë¸ ë‹¤ìš´ë¡œë“œ**: Cross-Encoder ë¦¬ë­ì»¤ ì‚¬ìš© ì‹œ ì•½ 100MB ëª¨ë¸ ë‹¤ìš´ë¡œë“œ

---

## ë¬¸ì œ í•´ê²°

### ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ

#### 1. ì¸ë±ìŠ¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
Error: Index not found. Run 'python build_index.py' first
```
**í•´ê²°**: `python build_index.py` ì‹¤í–‰

#### 2. ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
Error: data/documents.tsv not found
```
**í•´ê²°**: `python download_data.py` ì‹¤í–‰

#### 3. ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜
**í•´ê²°**: 
- ë°°ì¹˜ í¬ê¸° ì¤„ì´ê¸°
- ë” ë§ì€ RAM ì‚¬ìš© ê°€ëŠ¥í•œ í™˜ê²½ì—ì„œ ì‹¤í–‰

#### 4. ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨
**í•´ê²°**: 
- ì¸í„°ë„· ì—°ê²° í™•ì¸
- HuggingFace í† í° ì„¤ì • (í•„ìš”ì‹œ)

---

## ì°¸ê³  ìë£Œ

### í”„ë¡œì íŠ¸ ë¬¸ì„œ
- `PROJECT_REPORT.md`: ìƒì„¸í•œ í”„ë¡œì íŠ¸ ë³´ê³ ì„œ
- `REQUIREMENTS_CHECKLIST.md`: ìš”êµ¬ì‚¬í•­ ì²´í¬ë¦¬ìŠ¤íŠ¸
- `SUBMISSION_GUIDE.md`: ì œì¶œ ê°€ì´ë“œ

### ë°ì´í„°ì…‹
- **wikir/en1k**: [ir_datasets](https://ir-datasets.com/wikir.html#wikir/en1k)

### ì•Œê³ ë¦¬ì¦˜ ì°¸ê³ 
- BM25: Robertson & Zaragoza (2009)
- TF-IDF: Salton & Buckley (1988)
- TREC Eval: [TREC Guidelines](https://trec.nist.gov/)

---

## ë¼ì´ì„ ìŠ¤

ë³¸ í”„ë¡œì íŠ¸ëŠ” êµìœ¡ ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ë¬¸ì˜

í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì˜:
- ì´ë©”ì¼: hyunje.song@jbnu.ac.kr
- ë°©ë¬¸: ê³µëŒ€7í˜¸ê´€ 432í˜¸, 434í˜¸

---

**í”„ë¡œì íŠ¸ ê¸°ê°„**: 2025ë…„ 11ì›” - 12ì›”  
**í”„ë¡œê·¸ë˜ë° ì–¸ì–´**: Python 3.x  
**í”„ë ˆì„ì›Œí¬**: Streamlit, PyTorch, Transformers


---

## Dense Retrieval (HuggingFace)

This project now supports a bi-encoder dense retriever and a BM25 + Dense hybrid.
This improves accuracy, especially when combined with the reranker.

### 1) Build Dense Index

```bash
python build_dense_index.py --model BAAI/bge-base-en-v1.5 --batch-size 64 --max-length 512
```

Outputs: `data/dense_index.pt`

### 2) Evaluate with Dense Retrieval

```bash
python run_eval.py --dense
```

This will add dense and hybrid-dense runs in `results/`.

### 3) Use in Search Engine

Use `method="dense"` or `method="hybrid_dense"` in `SearchEngine.search()`.
For best accuracy, combine `hybrid_dense` with the reranker.

### Suggested Models (Accuracy Focus)
- Dense retriever: `BAAI/bge-base-en-v1.5` or `intfloat/e5-base-v2`
- Reranker: `BAAI/bge-reranker-v2-m3` (slower, highest accuracy)
